// import { Item } from "../../domain/entity/item";
// import { ApiService } from "../../domain/services/api";
// import { convert } from 'html-to-text';

// export class AtualService implements ApiService {
//     async get(): Promise<Item[]> {
//         const response = await fetch("https://atualfm.com.br/wp-admin/admin-ajax.php?td_theme_name=Newspaper&v=12.6.4", {
//             "headers": {
//               "accept": "*/*",
//               "content-type": "application/x-www-form-urlencoded; charset=UTF-8",
//               "sec-ch-ua": "\"Chromium\";v=\"128\", \"Not;A=Brand\";v=\"24\", \"Google Chrome\";v=\"128\"",
//               "sec-ch-ua-mobile": "?0",
//               "sec-ch-ua-platform": "\"macOS\"",
//               "x-requested-with": "XMLHttpRequest",
//               "Referer": "https://atualfm.com.br/",
//               "Referrer-Policy": "strict-origin-when-cross-origin"
//             },
//             "body": "action=td_ajax_block&td_atts=%7B%22modules_on_row%22%3A%22%22%2C%22limit%22%3A%2230%22%2C%22hide_audio%22%3A%22yes%22%2C%22category_ids%22%3A%22-2736%2C+-56%2C+-28%2C+-22%2C+-25%2C+-318%2C+-319%22%2C%22image_floated%22%3A%22float_left%22%2C%22image_height%22%3A%2260%22%2C%22image_width%22%3A%2235%22%2C%22m_padding%22%3A%220+0+20px%22%2C%22all_modules_space%22%3A%2220%22%2C%22modules_border_size%22%3A%220+0+1px+0%22%2C%22image_size%22%3A%22td_485x360%22%2C%22meta_info_align%22%3A%22center%22%2C%22meta_padding%22%3A%220+20px%22%2C%22modules_extra_cat%22%3A%22above%22%2C%22show_author%22%3A%22none%22%2C%22show_cat%22%3A%22none%22%2C%22modules_category%22%3A%22above%22%2C%22show_com%22%3A%22none%22%2C%22show_review%22%3A%22none%22%2C%22show_excerpt%22%3A%22none%22%2C%22show_btn%22%3A%22none%22%2C%22f_title_font_size%22%3A%2226%22%2C%22f_title_font_family%22%3A%22523%22%2C%22f_title_font_line_height%22%3A%22120%25%22%2C%22f_title_font_weight%22%3A%22800%22%2C%22f_cat_font_size%22%3A%2212%22%2C%22f_cat_font_weight%22%3A%22700%22%2C%22f_cat_font_transform%22%3A%22uppercase%22%2C%22title_txt_hover%22%3A%22%23ff6239%22%2C%22title_txt%22%3A%22%23000000%22%2C%22cat_bg%22%3A%22%23ffffff%22%2C%22cat_txt%22%3A%22%23ff6239%22%2C%22date_txt%22%3A%22%23888888%22%2C%22modules_category_padding%22%3A%220%22%2C%22f_ex_font_transform%22%3A%22%22%2C%22f_meta_font_transform%22%3A%22uppercase%22%2C%22f_meta_font_weight%22%3A%22600%22%2C%22meta_margin%22%3A%220%22%2C%22art_title%22%3A%2210px+0%22%2C%22f_meta_font_size%22%3A%2211%22%2C%22time_ago_add_txt%22%3A%22atr%C3%A1s%22%2C%22time_ago%22%3A%22yes%22%2C%22ajax_pagination%22%3A%22load_more%22%2C%22pag_bg%22%3A%22%23ff6239%22%2C%22pag_h_bg%22%3A%22rgba(255%2C98%2C57%2C0.85)%22%2C%22pag_text%22%3A%22%23ffffff%22%2C%22f_more_font_transform%22%3A%22uppercase%22%2C%22f_more_font_weight%22%3A%22800%22%2C%22f_more_font_spacing%22%3A%220.5PX%22%2C%22pag_border%22%3A%22%23ff6239%22%2C%22pag_h_border%22%3A%22rgba(255%2C98%2C57%2C0.85)%22%2C%22pag_padding%22%3A%2210px+20px%22%2C%22show_vid_t%22%3A%22none%22%2C%22block_type%22%3A%22td_flex_block_1%22%2C%22separator%22%3A%22%22%2C%22custom_title%22%3A%22%22%2C%22custom_url%22%3A%22%22%2C%22block_template_id%22%3A%22%22%2C%22title_tag%22%3A%22%22%2C%22mc1_tl%22%3A%22%22%2C%22mc1_title_tag%22%3A%22%22%2C%22mc1_el%22%3A%22%22%2C%22post_ids%22%3A%22%22%2C%22category_id%22%3A%22%22%2C%22taxonomies%22%3A%22%22%2C%22in_all_terms%22%3A%22%22%2C%22tag_slug%22%3A%22%22%2C%22autors_id%22%3A%22%22%2C%22installed_post_types%22%3A%22%22%2C%22include_cf_posts%22%3A%22%22%2C%22exclude_cf_posts%22%3A%22%22%2C%22sort%22%3A%22%22%2C%22popular_by_date%22%3A%22%22%2C%22linked_posts%22%3A%22%22%2C%22favourite_only%22%3A%22%22%2C%22offset%22%3A%22%22%2C%22open_in_new_window%22%3A%22%22%2C%22show_modified_date%22%3A%22%22%2C%22time_ago_txt_pos%22%3A%22%22%2C%22review_source%22%3A%22%22%2C%22el_class%22%3A%22%22%2C%22td_query_cache%22%3A%22%22%2C%22td_query_cache_expiration%22%3A%22%22%2C%22td_ajax_filter_type%22%3A%22%22%2C%22td_ajax_filter_ids%22%3A%22%22%2C%22td_filter_default_txt%22%3A%22All%22%2C%22td_ajax_preloading%22%3A%22%22%2C%22container_width%22%3A%22%22%2C%22modules_gap%22%3A%22%22%2C%22modules_border_style%22%3A%22%22%2C%22modules_border_color%22%3A%22%23eaeaea%22%2C%22modules_border_radius%22%3A%22%22%2C%22modules_divider%22%3A%22%22%2C%22modules_divider_color%22%3A%22%23eaeaea%22%2C%22h_effect%22%3A%22%22%2C%22image_alignment%22%3A%2250%22%2C%22image_radius%22%3A%22%22%2C%22hide_image%22%3A%22%22%2C%22show_favourites%22%3A%22%22%2C%22fav_size%22%3A%222%22%2C%22fav_space%22%3A%22%22%2C%22fav_ico_color%22%3A%22%22%2C%22fav_ico_color_h%22%3A%22%22%2C%22fav_bg%22%3A%22%22%2C%22fav_bg_h%22%3A%22%22%2C%22fav_shadow_shadow_header%22%3A%22%22%2C%22fav_shadow_shadow_title%22%3A%22Shadow%22%2C%22fav_shadow_shadow_size%22%3A%22%22%2C%22fav_shadow_shadow_offset_horizontal%22%3A%22%22%2C%22fav_shadow_shadow_offset_vertical%22%3A%22%22%2C%22fav_shadow_shadow_spread%22%3A%22%22%2C%22fav_shadow_shadow_color%22%3A%22%22%2C%22video_icon%22%3A%22%22%2C%22video_popup%22%3A%22yes%22%2C%22video_rec%22%3A%22%22%2C%22spot_header%22%3A%22%22%2C%22video_rec_title%22%3A%22%22%2C%22video_rec_color%22%3A%22%22%2C%22video_rec_disable%22%3A%22%22%2C%22autoplay_vid%22%3A%22yes%22%2C%22vid_t_margin%22%3A%22%22%2C%22vid_t_padding%22%3A%22%22%2C%22video_title_color%22%3A%22%22%2C%22video_title_color_h%22%3A%22%22%2C%22video_bg%22%3A%22%22%2C%22video_overlay%22%3A%22%22%2C%22vid_t_color%22%3A%22%22%2C%22vid_t_bg_color%22%3A%22%22%2C%22f_vid_title_font_header%22%3A%22%22%2C%22f_vid_title_font_title%22%3A%22Video+pop-up+article+title%22%2C%22f_vid_title_font_settings%22%3A%22%22%2C%22f_vid_title_font_family%22%3A%22%22%2C%22f_vid_title_font_size%22%3A%22%22%2C%22f_vid_title_font_line_height%22%3A%22%22%2C%22f_vid_title_font_style%22%3A%22%22%2C%22f_vid_title_font_weight%22%3A%22%22%2C%22f_vid_title_font_transform%22%3A%22%22%2C%22f_vid_title_font_spacing%22%3A%22%22%2C%22f_vid_title_%22%3A%22%22%2C%22f_vid_time_font_title%22%3A%22Video+duration+text%22%2C%22f_vid_time_font_settings%22%3A%22%22%2C%22f_vid_time_font_family%22%3A%22%22%2C%22f_vid_time_font_size%22%3A%22%22%2C%22f_vid_time_font_line_height%22%3A%22%22%2C%22f_vid_time_font_style%22%3A%22%22%2C%22f_vid_time_font_weight%22%3A%22%22%2C%22f_vid_time_font_transform%22%3A%22%22%2C%22f_vid_time_font_spacing%22%3A%22%22%2C%22f_vid_time_%22%3A%22%22%2C%22meta_info_horiz%22%3A%22layout-default%22%2C%22meta_width%22%3A%22%22%2C%22meta_space%22%3A%22%22%2C%22art_btn%22%3A%22%22%2C%22meta_info_border_size%22%3A%22%22%2C%22meta_info_border_style%22%3A%22%22%2C%22meta_info_border_color%22%3A%22%23eaeaea%22%2C%22meta_info_border_radius%22%3A%22%22%2C%22modules_category_margin%22%3A%22%22%2C%22modules_cat_border%22%3A%22%22%2C%22modules_category_radius%22%3A%220%22%2C%22author_photo%22%3A%22%22%2C%22author_photo_size%22%3A%22%22%2C%22author_photo_space%22%3A%22%22%2C%22author_photo_radius%22%3A%22%22%2C%22show_date%22%3A%22inline-block%22%2C%22review_space%22%3A%22%22%2C%22review_size%22%3A%222.5%22%2C%22review_distance%22%3A%22%22%2C%22art_excerpt%22%3A%22%22%2C%22excerpt_col%22%3A%221%22%2C%22excerpt_gap%22%3A%22%22%2C%22excerpt_middle%22%3A%22%22%2C%22excerpt_inline%22%3A%22%22%2C%22show_audio%22%3A%22block%22%2C%22art_audio%22%3A%22%22%2C%22art_audio_size%22%3A%221.5%22%2C%22btn_title%22%3A%22%22%2C%22btn_margin%22%3A%22%22%2C%22btn_padding%22%3A%22%22%2C%22btn_border_width%22%3A%22%22%2C%22btn_radius%22%3A%22%22%2C%22pag_space%22%3A%22%22%2C%22pag_border_width%22%3A%22%22%2C%22pag_border_radius%22%3A%22%22%2C%22prev_tdicon%22%3A%22%22%2C%22next_tdicon%22%3A%22%22%2C%22pag_icons_size%22%3A%22%22%2C%22f_header_font_header%22%3A%22%22%2C%22f_header_font_title%22%3A%22Block+header%22%2C%22f_header_font_settings%22%3A%22%22%2C%22f_header_font_family%22%3A%22%22%2C%22f_header_font_size%22%3A%22%22%2C%22f_header_font_line_height%22%3A%22%22%2C%22f_header_font_style%22%3A%22%22%2C%22f_header_font_weight%22%3A%22%22%2C%22f_header_font_transform%22%3A%22%22%2C%22f_header_font_spacing%22%3A%22%22%2C%22f_header_%22%3A%22%22%2C%22f_ajax_font_title%22%3A%22Ajax+categories%22%2C%22f_ajax_font_settings%22%3A%22%22%2C%22f_ajax_font_family%22%3A%22%22%2C%22f_ajax_font_size%22%3A%22%22%2C%22f_ajax_font_line_height%22%3A%22%22%2C%22f_ajax_font_style%22%3A%22%22%2C%22f_ajax_font_weight%22%3A%22%22%2C%22f_ajax_font_transform%22%3A%22%22%2C%22f_ajax_font_spacing%22%3A%22%22%2C%22f_ajax_%22%3A%22%22%2C%22f_more_font_title%22%3A%22Load+more+button%22%2C%22f_more_font_settings%22%3A%22%22%2C%22f_more_font_family%22%3A%22%22%2C%22f_more_font_size%22%3A%22%22%2C%22f_more_font_line_height%22%3A%22%22%2C%22f_more_font_style%22%3A%22%22%2C%22f_more_%22%3A%22%22%2C%22f_title_font_header%22%3A%22%22%2C%22f_title_font_title%22%3A%22Article+title%22%2C%22f_title_font_settings%22%3A%22%22%2C%22f_title_font_style%22%3A%22%22%2C%22f_title_font_transform%22%3A%22%22%2C%22f_title_font_spacing%22%3A%22%22%2C%22f_title_%22%3A%22%22%2C%22f_cat_font_title%22%3A%22Article+category+tag%22%2C%22f_cat_font_settings%22%3A%22%22%2C%22f_cat_font_family%22%3A%22%22%2C%22f_cat_font_line_height%22%3A%22%22%2C%22f_cat_font_style%22%3A%22%22%2C%22f_cat_font_spacing%22%3A%22%22%2C%22f_cat_%22%3A%22%22%2C%22f_meta_font_title%22%3A%22Article+meta+info%22%2C%22f_meta_font_settings%22%3A%22%22%2C%22f_meta_font_family%22%3A%22%22%2C%22f_meta_font_line_height%22%3A%22%22%2C%22f_meta_font_style%22%3A%22%22%2C%22f_meta_font_spacing%22%3A%22%22%2C%22f_meta_%22%3A%22%22%2C%22f_ex_font_title%22%3A%22Article+excerpt%22%2C%22f_ex_font_settings%22%3A%22%22%2C%22f_ex_font_family%22%3A%22%22%2C%22f_ex_font_size%22%3A%22%22%2C%22f_ex_font_line_height%22%3A%22%22%2C%22f_ex_font_style%22%3A%22%22%2C%22f_ex_font_weight%22%3A%22%22%2C%22f_ex_font_spacing%22%3A%22%22%2C%22f_ex_%22%3A%22%22%2C%22f_btn_font_title%22%3A%22Article+read+more+button%22%2C%22f_btn_font_settings%22%3A%22%22%2C%22f_btn_font_family%22%3A%22%22%2C%22f_btn_font_size%22%3A%22%22%2C%22f_btn_font_line_height%22%3A%22%22%2C%22f_btn_font_style%22%3A%22%22%2C%22f_btn_font_weight%22%3A%22%22%2C%22f_btn_font_transform%22%3A%22%22%2C%22f_btn_font_spacing%22%3A%22%22%2C%22f_btn_%22%3A%22%22%2C%22mix_color%22%3A%22%22%2C%22mix_type%22%3A%22%22%2C%22fe_brightness%22%3A%221%22%2C%22fe_contrast%22%3A%221%22%2C%22fe_saturate%22%3A%221%22%2C%22mix_color_h%22%3A%22%22%2C%22mix_type_h%22%3A%22%22%2C%22fe_brightness_h%22%3A%221%22%2C%22fe_contrast_h%22%3A%221%22%2C%22fe_saturate_h%22%3A%221%22%2C%22m_bg%22%3A%22%22%2C%22color_overlay%22%3A%22%22%2C%22shadow_shadow_header%22%3A%22%22%2C%22shadow_shadow_title%22%3A%22Module+Shadow%22%2C%22shadow_shadow_size%22%3A%22%22%2C%22shadow_shadow_offset_horizontal%22%3A%22%22%2C%22shadow_shadow_offset_vertical%22%3A%22%22%2C%22shadow_shadow_spread%22%3A%22%22%2C%22shadow_shadow_color%22%3A%22%22%2C%22all_underline_height%22%3A%22%22%2C%22all_underline_color%22%3A%22%22%2C%22cat_bg_hover%22%3A%22%22%2C%22cat_txt_hover%22%3A%22%22%2C%22cat_border%22%3A%22%22%2C%22cat_border_hover%22%3A%22%22%2C%22meta_bg%22%3A%22%22%2C%22author_txt%22%3A%22%22%2C%22author_txt_hover%22%3A%22%22%2C%22ex_txt%22%3A%22%22%2C%22com_bg%22%3A%22%22%2C%22com_txt%22%3A%22%22%2C%22rev_txt%22%3A%22%22%2C%22audio_btn_color%22%3A%22%22%2C%22audio_time_color%22%3A%22%22%2C%22audio_bar_color%22%3A%22%22%2C%22audio_bar_curr_color%22%3A%22%22%2C%22shadow_m_shadow_header%22%3A%22%22%2C%22shadow_m_shadow_title%22%3A%22Meta+info+shadow%22%2C%22shadow_m_shadow_size%22%3A%22%22%2C%22shadow_m_shadow_offset_horizontal%22%3A%22%22%2C%22shadow_m_shadow_offset_vertical%22%3A%22%22%2C%22shadow_m_shadow_spread%22%3A%22%22%2C%22shadow_m_shadow_color%22%3A%22%22%2C%22btn_bg%22%3A%22%22%2C%22btn_bg_hover%22%3A%22%22%2C%22btn_txt%22%3A%22%22%2C%22btn_txt_hover%22%3A%22%22%2C%22btn_border%22%3A%22%22%2C%22btn_border_hover%22%3A%22%22%2C%22pag_h_text%22%3A%22%22%2C%22ajax_pagination_next_prev_swipe%22%3A%22%22%2C%22ajax_pagination_infinite_stop%22%3A%22%22%2C%22css%22%3A%22%22%2C%22tdc_css%22%3A%22%22%2C%22td_column_number%22%3A1%2C%22header_color%22%3A%22%22%2C%22color_preset%22%3A%22%22%2C%22border_top%22%3A%22%22%2C%22class%22%3A%22tdi_125%22%2C%22tdc_css_class%22%3A%22tdi_125%22%2C%22tdc_css_class_style%22%3A%22tdi_125_rand_style%22%7D&td_block_id=tdi_125&td_column_number=1&td_current_page=2&block_type=td_flex_block_1&td_filter_value=&td_user_action=&td_magic_token=14a7d8b252",
//             "method": "POST"
//           });

//         const data = await response.json();
//         const dataText = convert(data.td_data, { wordwrap: 130 });
//         const dataTextArray = dataText.split('\n');
//         let itemsArray = dataTextArray.filter(item => {
//             if (item != '' && !this.isLink(item) && !item.includes('atrás') && this.hasUpperCase(item)) 
//                 return item
//         })
//         const itemList = itemsArray.map(item => new Item(item, 'atual'))
//         return itemList;
//     }

//     private hasUpperCase(str: string) {
//         return str == str.toUpperCase();
//     }

//     private isLink(str: string) {
//         return str.slice(0,6) == '[https' || str.slice(0,5) == 'https'
//     }

// }

import { Item } from "../../domain/entity/item";
import { ApiService } from "../../domain/services/api";
import * as cheerio from 'cheerio';

export class AtualService implements ApiService {
    private baseUrl: string = 'https://www.atualfm.com.br/'

    async get(): Promise<Item[]> {
        const output: Item[] = [];
        // for (let visitedPages = 1; visitedPages <= 5; visitedPages++) {
            const response = await fetch(`${this.baseUrl}`);
            const mainHtml = await response.text();
            const $ = cheerio.load(mainHtml);
            const news = $('.entry-title');
            // console.log(news)
            news.each(function (idx, el) {
                output.push(new Item($(el).text().trim(), 'atual'))
              });
        // }
        
        return output;
    }

    
}